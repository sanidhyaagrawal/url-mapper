{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <title>URL mapping | cruvâ„¢</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0, user-scalable=no" /> 
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22256%22 height=%22256%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%23000000%22></rect><path d=%22M11.36 50.01Q11.36 47.06 12.69 44.69Q14.03 42.33 16.33 41.00Q18.64 39.66 21.45 39.66L21.45 39.66Q24.76 39.66 27.22 41.26Q29.69 42.85 30.82 45.78L30.82 45.78L27.66 45.78Q26.81 43.95 25.23 42.97Q23.65 41.98 21.45 41.98L21.45 41.98Q19.33 41.98 17.65 42.97Q15.97 43.95 15.01 45.77Q14.05 47.58 14.05 50.01L14.05 50.01Q14.05 52.42 15.01 54.23Q15.97 56.05 17.65 57.03Q19.33 58.02 21.45 58.02L21.45 58.02Q23.65 58.02 25.23 57.05Q26.81 56.08 27.66 54.25L27.66 54.25L30.82 54.25Q29.69 57.15 27.22 58.73Q24.76 60.31 21.45 60.31L21.45 60.31Q18.64 60.31 16.33 58.99Q14.03 57.67 12.69 55.32Q11.36 52.97 11.36 50.01L11.36 50.01ZM48.54 60.14L45.37 60.14L40.56 51.87L37.37 51.87L37.37 60.14L34.73 60.14L34.73 39.92L41.26 39.92Q43.55 39.92 45.13 40.71Q46.71 41.49 47.49 42.82Q48.27 44.16 48.27 45.87L48.27 45.87Q48.27 47.96 47.07 49.55Q45.87 51.15 43.46 51.67L43.46 51.67L48.54 60.14ZM37.37 42.10L37.37 49.75L41.26 49.75Q43.40 49.75 44.48 48.70Q45.55 47.64 45.55 45.87L45.55 45.87Q45.55 44.07 44.49 43.08Q43.43 42.10 41.26 42.10L41.26 42.10L37.37 42.10ZM52.31 39.92L54.94 39.92L54.94 52.71Q54.94 55.41 56.26 56.71Q57.58 58.02 59.93 58.02L59.93 58.02Q62.25 58.02 63.57 56.71Q64.89 55.41 64.89 52.71L64.89 52.71L64.89 39.92L67.53 39.92L67.53 52.68Q67.53 55.21 66.52 56.93Q65.50 58.66 63.78 59.50Q62.05 60.34 59.90 60.34L59.90 60.34Q57.76 60.34 56.03 59.50Q54.31 58.66 53.31 56.93Q52.31 55.21 52.31 52.68L52.31 52.68L52.31 39.92ZM85.86 39.92L88.64 39.92L81.02 60.14L77.97 60.14L70.34 39.92L73.16 39.92L79.51 57.35L85.86 39.92Z%22 fill=%22%23fff%22></path></svg>" />

  <style>
      .container {
  width: 100vw;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  
}


.bottomm{
    position: absolute;
  bottom: 8px;
  right: 16px;
  font-size: 18px;
}

.topp{
    position: absolute;
  top: 8px;
  left: 16px;
  font-size: 18px;
}

  </style>
</head>
<body style="background-color: black;">
    <div class="container">
        <div class="row">
            <div class =" topp pull-left" style="align-items: baseline;justify-content: baseline;text-align: end;">
                <img src="{% static 'logo.png' %}">
            </div>
        </div>
        <form id="edit" name="edit">
            <div class="form-group" style="width: 85vw;  max-width: 500px;">
        
              <input type="text" class="form-control" style="color:white;background-color: #000;" name="base" id = "base" aria-describedby="emailHelp" placeholder="url.cruv.dev/" style="background-color: black;">

            </div>

            <div class="form-group">
        
                <input type="text" class="form-control" style="color:white;background-color: #000;" name="target" id="target" aria-describedby="emailHelp" placeholder="URL" style="background-color: black;" >

              </div>
             <div style="align-items: center;justify-content: center;text-align: center;">

              <a id="login" href=""><i class="fa fa-check-circle" style="font-size:30px;color:white;"></i></a>
            </div> 
            </form>
<div class="row">
    <div class =" bottomm pull-right" style="align-items: baseline;justify-content: baseline;text-align: end;">
      <a href="/admin/a0f4762cdeaecdb87576f634aec5bb0c904817ee6655d932de044dd890da398d/website/sites/"><i class="fa fa-edit" style="font-size:30px;color:white;"></i></a>
      <a href="logout"><i class="fa fa-sign-out" style="font-size:30px;color:white;"></i></a>

    </div>
</div>
        
    </div>

</body>
</html>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src ="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script>
  var lock = false
  $('#login').click(function(e) {
      e.preventDefault();
      if (lock == false) {
      lock = true
      var myform = document.getElementById("edit");
      var formData = new FormData(myform);
      $('#login').prop('disabled', true);
      $('#cancel').prop('disabled', true);
      $("#login").html('<div class="spinner-border" style="width: 30px; height: 30px; color:white;" role="status"></div>');
      $.ajax({
          url: "/api/short/",
          type: 'POST',
          data: formData,
          cache: false,
          contentType: false,
          processData: false,
          success: function(data, textStatus, xhr) {
            
              console.log(data);
              if(xhr.status == 200) {

           


                  $('#login').prop('disabled', false);
                  $('#cancel').prop('disabled', false);
                  $("#login").html('<p style="color:white; font-size:10px;">' + data.error + '</p>');
                  setTimeout(function() {
                    $("#login").html('<i class="fa fa-check-circle" style="font-size:30px;color:white;"></i>');
                    lock = false
                  }, 2000);
                  
              } else if(xhr.status == 202) {
                var base = window.location.host
                var copyText = document.getElementById("base");
                copyText.value = base + '/'+ copyText.value
                copyText.select();
                copyText.setSelectionRange(0, 99999)
                document.execCommand("copy");
                window.location.reload();
              }
          },
          error: function(xhr, errmsg, err) {
             
              $('#login').prop('disabled', false);
              $('#cancel').prop('disabled', false);
              $("#login").html('<p style="color:white; font-size:10px;"> Something went wrong </p>');
              setTimeout(function() {
                $("#login").html('<i class="fa fa-check-circle" style="font-size:30px;color:white;"></i>');
                lock = false
              }, 2000);
              
          },
      });
    }
  });


  var input = document.getElementById("target");
  input.addEventListener("keyup", function(event) {
    if (event.keyCode === 13) {
     event.preventDefault();
     document.getElementById("login").click();
    }
  });
</script>

  